# Default values for the Demo Bookstore Suite
# All images pull from GHCR (public, no rate limits, no auth required)
#
# Usage:
#   helm install demo ./helm/demo-suite --set global.domain=<your-domain>
#   helm install demo ./helm/demo-suite -f ./helm/demo-suite/values-small.yaml --set global.domain=<your-domain>
#   helm install demo ./helm/demo-suite -f ./helm/demo-suite/values-harbor.yaml

global:
  # Storage class for all PVCs (empty = cluster default)
  storageClassName: ""
  # Base domain for ingress hostnames
  # Generates: bookstore.<domain>, reader.<domain>, chatbot.<domain>
  domain: "example.local"
  # Image pull secrets (empty = public images, no auth needed)
  imagePullSecrets: []

# --- Bookstore (main application) ---
bookstore:
  image:
    repository: ghcr.io/tmm-demo-apps/bookstore-app
    tag: latest
    pullPolicy: IfNotPresent
  replicas: 3
  resources:
    requests:
      memory: "128Mi"
      cpu: "100m"
    limits:
      memory: "512Mi"
      cpu: "500m"
  ingress:
    host: ""
  postgres:
    image: ghcr.io/tmm-demo-apps/postgres:14-alpine
    storage: 10Gi
    resources:
      requests:
        memory: "256Mi"
        cpu: "250m"
      limits:
        memory: "1Gi"
        cpu: "1000m"
  redis:
    image: ghcr.io/tmm-demo-apps/redis:7-alpine
    storage: 5Gi
    resources:
      requests:
        memory: "128Mi"
        cpu: "100m"
      limits:
        memory: "512Mi"
        cpu: "500m"
  elasticsearch:
    enabled: true
    image: ghcr.io/tmm-demo-apps/elasticsearch:8.11.0
    storage: 10Gi
    resources:
      requests:
        memory: "1Gi"
        cpu: "500m"
      limits:
        memory: "2Gi"
        cpu: "1000m"
  minio:
    image: ghcr.io/tmm-demo-apps/minio:latest
    storage: 20Gi
    resources:
      requests:
        memory: "256Mi"
        cpu: "250m"
      limits:
        memory: "1Gi"
        cpu: "1000m"
  secrets:
    create: true
    dbUser: bookstore
    dbPassword: bookstore-secret-pw
    minioAccessKey: minioadmin
    minioSecretKey: minioadmin-secret
  initJob:
    enabled: true
  hpa:
    enabled: true
    minReplicas: 3
    maxReplicas: 10
    cpuUtilization: 70
    memoryUtilization: 80

# --- Reader (e-book reader) ---
reader:
  enabled: true
  image:
    repository: ghcr.io/tmm-demo-apps/reader-app
    tag: latest
    pullPolicy: IfNotPresent
  replicas: 2
  resources:
    requests:
      memory: "128Mi"
      cpu: "100m"
    limits:
      memory: "512Mi"
      cpu: "500m"
  ingress:
    host: ""
  postgres:
    image: ghcr.io/tmm-demo-apps/postgres:14-alpine
    storage: 5Gi
    resources:
      requests:
        memory: "256Mi"
        cpu: "100m"
      limits:
        memory: "512Mi"
        cpu: "500m"
  secrets:
    create: true
    postgresPassword: reader-secret-pw
    databaseUrl: "postgres://reader:reader-secret-pw@reader-postgres:5432/reader?sslmode=disable"
    minioAccessKey: minioadmin
    minioSecretKey: minioadmin-secret
    sessionSecret: reader-session-secret-change-me

# --- Chatbot (AI assistant) ---
chatbot:
  enabled: true
  image:
    repository: ghcr.io/tmm-demo-apps/chatbot-app
    tag: latest
    pullPolicy: IfNotPresent
  replicas: 1
  ingress:
    host: ""
  ollama:
    enabled: true
    image: ghcr.io/tmm-demo-apps/ollama:latest
    replicas: 0
    storage: 5Gi
    model: "smollm2:360m"
  llm:
    backend: "openai_compatible"
    apiURL: "http://ollama:11434"
    model: "smollm2:360m"
  secrets:
    create: true
    llmApiKey: ""

# --- Ingress Controller (optional) ---
# Enable if your cluster does not already have an ingress controller installed.
# Most managed K8s clusters and VCF/TKG environments already have one.
ingress-nginx:
  enabled: false
  controller:
    replicaCount: 2
    service:
      type: LoadBalancer

apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization

# Default namespace - Kustomize applies this to all resources
namespace: bookstore

# Resources to include (order matters for dependencies)
resources:
  - namespace.yaml
  - secret.yaml
  - configmap.yaml
  - postgres.yaml
  - redis.yaml
  - elasticsearch.yaml
  - minio.yaml
  - migrations-configmap.yaml
  - app.yaml
  - ingress.yaml
  - hpa.yaml
  # Note: init-db-job.yaml is a one-time job, apply separately after infrastructure is ready
  # Note: ingress-nginx.yaml deploys to ingress-nginx namespace, apply separately

# Image overrides - CI/CD updates these tags
images:
  - name: harbor.corp.vmbeans.com/bookstore/app
    newTag: e9e13d5a186ebcb091ff1846831b205507f9692c
  - name: harbor.corp.vmbeans.com/library/postgres
    newTag: e9e13d5a186ebcb091ff1846831b205507f9692c
  - name: harbor.corp.vmbeans.com/library/redis
    newTag: e9e13d5a186ebcb091ff1846831b205507f9692c
  - name: harbor.corp.vmbeans.com/library/elasticsearch
    newTag: e9e13d5a186ebcb091ff1846831b205507f9692c
  - name: harbor.corp.vmbeans.com/library/minio/minio
    newTag: e9e13d5a186ebcb091ff1846831b205507f9692c
